# Verifiable WMTP Local Test (Micro model)
# M3 Mac 경량 테스트용

project:
  name: weighted-mtp
  version: "0.2.0"

experiment:
  name: verifiable-wmtp-local
  description: "Local test with micro model"
  stage: verifiable
  tags:
    - verifiable
    - local
    - micro-model
  critic_checkpoint: storage/checkpoints/critic/critic-pretrain-local/checkpoint_epoch_0.10.pt

models:
  policy:
    name: micro-mtp
    path: storage/models/micro-mtp
    tokenizer_path: storage/models/meta-llama-mtp/tokenizer
    dtype: float32

dataset:
  name: codecontests
  train: storage/datasets/codecontests/processed/train.jsonl
  validation: storage/datasets/codecontests/processed/valid.jsonl
  max_length: 512

data_sampling:
  n_samples: 500
  balance_correct: true
  correct_ratio: 0.5
  curriculum_learning: false
  seed: 42

training:
  n_epochs: 0.2
  batch_size: 2
  gradient_accumulation_steps: 2
  learning_rate: 1.0e-5
  max_grad_norm: 0.5
  beta: 0.9
  value_coef: 0.5
  weight_clip_min: 0.1
  weight_clip_max: 3.0
  loss_type: mse
  log_interval: 5

checkpoint:
  save_dir: storage/checkpoints/verifiable/${experiment.name}
  save_checkpoint_every: 0.2
  save_best: true
  save_final: true
  save_total_limit: 2

runtime:
  device: mps
  seed: 42
  mixed_precision: false

distributed:
  fsdp:
    sharding_strategy: NO_SHARD
    mixed_precision: false
    cpu_offload: false

storage:
  root: storage
  models_dir: storage/models
  datasets_dir: storage/datasets
  checkpoints_dir: storage/checkpoints
  s3_bucket: "s3://wmtp"
  s3_checkpoints_prefix: "checkpoints/verifiable"

mlflow:
  tracking_uri: ""
  experiment: ""
  s3_artifacts: ""

logging:
  level: INFO
  format: "%(asctime)s [%(levelname)s] [%(name)s] %(message)s"
